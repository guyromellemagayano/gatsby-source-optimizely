{"version":3,"file":"request.js","names":["Request","hostname","headers","response_type","request_timeout","REQUEST_TIMEOUT","request_throttle_interval","REQUEST_THROTTLE_INTERVAL","request_debounce_interval","REQUEST_DEBOUNCE_INTERVAL","request_concurrency","REQUEST_CONCURRENCY","pending_requests","REQUEST_PENDING_COUNT","run","url","method","body","updatedMethod","convertStringToLowercase","config","responseType","withCredentials","timeout","axios","defaults","common","REQUEST_ACCEPT_HEADER","console","log","RequestAxiosInstance","create","interceptors","request","use","Promise","resolve","debounceInterval","debounce","throttleInterval","throttle","clearInterval","warn","convertStringToUppercase","res","info","status","statusText","err","reject","error","message","response","Math","max","get","post","Error"],"sources":["../src/libs/request.js"],"sourcesContent":["\"use strict\";\n\nimport axios from \"axios\";\nimport { REQUEST_ACCEPT_HEADER, REQUEST_CONCURRENCY, REQUEST_DEBOUNCE_INTERVAL, REQUEST_PENDING_COUNT, REQUEST_THROTTLE_INTERVAL, REQUEST_TIMEOUT } from \"../constants\";\nimport { convertStringToLowercase, convertStringToUppercase } from \"../utils/convertValues\";\nimport { debounce } from \"../utils/debounce\";\nimport { throttle } from \"../utils/throttle\";\n\nexport class Request {\n\tconstructor(\n\t\thostname,\n\t\t{ headers = {}, response_type = \"\", request_timeout = REQUEST_TIMEOUT, request_throttle_interval = REQUEST_THROTTLE_INTERVAL, request_debounce_interval = REQUEST_DEBOUNCE_INTERVAL, request_concurrency = REQUEST_CONCURRENCY } = {}\n\t) {\n\t\tthis.hostname = hostname;\n\t\tthis.response_type = response_type;\n\t\tthis.headers = headers;\n\t\tthis.pending_requests = REQUEST_PENDING_COUNT;\n\t\tthis.request_timeout = request_timeout;\n\t\tthis.request_throttle_interval = request_throttle_interval;\n\t\tthis.request_debounce_interval = request_debounce_interval;\n\t\tthis.request_concurrency = request_concurrency;\n\t}\n\n\t// Handle running plugin\n\tasync run(url = \"\", method = \"\", body = null, headers = {}) {\n\t\tconst updatedMethod = convertStringToLowercase(method);\n\n\t\tlet config = {\n\t\t\theaders: {\n\t\t\t\t...this.headers,\n\t\t\t\t...headers\n\t\t\t},\n\t\t\tresponseType: this.response_type,\n\t\t\twithCredentials: true,\n\t\t\ttimeout: this.request_timeout\n\t\t};\n\n\t\t// Override default `axios` instance\n\t\taxios.defaults.headers.common[\"Accept\"] = REQUEST_ACCEPT_HEADER;\n\t\taxios.defaults.headers.common[\"Content-Type\"] = REQUEST_ACCEPT_HEADER;\n\n\t\tconsole.log(config);\n\n\t\t// Custom `request` instance\n\t\tconst RequestAxiosInstance = axios.create(config);\n\n\t\t// Use `axios` interceptors for all HTTP methods (GET, POST, PUT, DELETE, etc.)\n\t\tRequestAxiosInstance.interceptors.request.use(\n\t\t\t(config) =>\n\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\t// Debounce requests to avoid rate limiting\n\t\t\t\t\tlet debounceInterval = debounce(() => this.pending_requests--, this.request_debounce_interval);\n\n\t\t\t\t\t// Throttle requests to avoid rate limiting\n\t\t\t\t\tlet throttleInterval = throttle(() => {\n\t\t\t\t\t\tclearInterval(throttleInterval);\n\t\t\t\t\t\tdebounceInterval();\n\t\t\t\t\t\tresolve(config);\n\t\t\t\t\t}, this.request_throttle_interval);\n\n\t\t\t\t\tif (this.pending_requests <= this.request_concurrency) {\n\t\t\t\t\t\tconsole.warn(`[${convertStringToUppercase(method)}] ${url} - (SENT)`);\n\n\t\t\t\t\t\t// Wait for all throttle to clear\n\t\t\t\t\t\tthrottleInterval();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.pending_requests > this.request_concurrency) {\n\t\t\t\t\t\t// Return null if there are too many pending requests\n\t\t\t\t\t\tconsole.warn(`[${convertStringToUppercase(method)}] ${url} - (THROTTLED) (${this.pending_requests} pending ${this.pending_requests > 1 ? \"requests\" : \"request\"})`);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Increment pending requests\n\t\t\t\t\tthis.pending_requests++;\n\n\t\t\t\t\treturn config;\n\t\t\t\t})\n\t\t),\n\t\t\t(res) =>\n\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\t// Send info message to console if request is successful\n\t\t\t\t\tconsole.info(`[${convertStringToUppercase(method)}] ${url} - (${res.status} ${res.statusText})`);\n\t\t\t\t\tresolve(res);\n\n\t\t\t\t\t// Return response\n\t\t\t\t\treturn res;\n\t\t\t\t}),\n\t\t\t(err) =>\n\t\t\t\tnew Promise((reject) => {\n\t\t\t\t\t// Send error message to console if request fails\n\t\t\t\t\tconsole.error(`[${convertStringToUppercase(method)}] ${url} - (ERROR)`);\n\t\t\t\t\tconsole.error(\"\\n\", err.message, \"\\n\");\n\t\t\t\t\treject(err);\n\n\t\t\t\t\t// Return error message\n\t\t\t\t\treturn err;\n\t\t\t\t});\n\n\t\t// Use `axios` interceptors for all HTTP methods (GET, POST, PUT, DELETE, etc.)\n\t\tRequestAxiosInstance.interceptors.response.use(\n\t\t\t(res) =>\n\t\t\t\tnew Promise((resolve) => {\n\t\t\t\t\t// Decrement pending requests\n\t\t\t\t\tthis.pending_requests = Math.max(0, this.pending_requests > 0 ? this.pending_requests - 1 : 0);\n\n\t\t\t\t\t// Send info message to console if request is successful\n\t\t\t\t\tconsole.info(`[${convertStringToUppercase(method)}] ${url} - (${res.status} ${res.statusText}) (${this.pending_requests} pending ${this.pending_requests > 1 ? \"requests\" : \"request\"})`);\n\n\t\t\t\t\t// Return response\n\t\t\t\t\treturn resolve(res);\n\t\t\t\t})\n\t\t),\n\t\t\t(err) =>\n\t\t\t\tnew Promise((reject) => {\n\t\t\t\t\tif (err.response) {\n\t\t\t\t\t\t// Decrement pending requests\n\t\t\t\t\t\tthis.pending_requests = Math.max(0, this.pending_requests > 0 ? this.pending_requests - 1 : 0);\n\n\t\t\t\t\t\t// Send log message when error response is received\n\t\t\t\t\t\tconsole.error(`[${convertStringToUppercase(method)}] ${url} - (${err.response.status} ${err.response.statusText})`);\n\t\t\t\t\t} else if (err.request) {\n\t\t\t\t\t\t// Decrement pending requests\n\t\t\t\t\t\tthis.pending_requests = Math.max(0, this.pending_requests > 0 ? this.pending_requests - 1 : 0);\n\n\t\t\t\t\t\t// Send log message when error request is received\n\t\t\t\t\t\tconsole.error(`[${convertStringToUppercase(method)}] ${url} - (${err.request.status} ${err.request.statusText})`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Send log message when error is thrown\n\t\t\t\t\t\tconsole.error(`[${convertStringToUppercase(method)}] ${url} - (ERROR)`);\n\t\t\t\t\t\tconsole.error(\"\\n\", err.message, \"\\n\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// Return error message\n\t\t\t\t\treturn reject(err);\n\t\t\t\t});\n\n\t\tswitch (updatedMethod) {\n\t\t\tcase \"get\":\n\t\t\t\tawait RequestAxiosInstance.get(url, body);\n\t\t\t\tbreak;\n\t\t\tcase \"post\":\n\t\t\t\tawait RequestAxiosInstance.post(url, body);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`The ${updatedMethod} method is currently not supported.`);\n\t\t}\n\t}\n}\n"],"mappings":"AAAA,YAAY,CAAC,2kBAQAA,OAAO,YACnB,iBACCC,QAAQ,OAEP,yBADkO,CAAC,CAAC,yBAAnOC,OAAO,CAAPA,OAAO,uBAAG,CAAC,CAAC,sCAAEC,aAAa,CAAbA,aAAa,6BAAG,EAAE,8CAAEC,eAAe,CAAfA,eAAe,+BAAGC,0BAAe,iDAAEC,yBAAyB,CAAzBA,yBAAyB,gCAAGC,oCAAyB,kDAAEC,yBAAyB,CAAzBA,yBAAyB,gCAAGC,oCAAyB,kDAAEC,mBAAmB,CAAnBA,mBAAmB,gCAAGC,8BAAmB,uBAE9N,IAAI,CAACV,QAAQ,CAAGA,QAAQ,CACxB,IAAI,CAACE,aAAa,CAAGA,aAAa,CAClC,IAAI,CAACD,OAAO,CAAGA,OAAO,CACtB,IAAI,CAACU,gBAAgB,CAAGC,gCAAqB,CAC7C,IAAI,CAACT,eAAe,CAAGA,eAAe,CACtC,IAAI,CAACE,yBAAyB,CAAGA,yBAAyB,CAC1D,IAAI,CAACE,yBAAyB,CAAGA,yBAAyB,CAC1D,IAAI,CAACE,mBAAmB,CAAGA,mBAC5B,CAAC,2CAGKI,GAAG,+HAAT,iBAAUC,GAAG,CAAOC,MAAM,CAAOC,IAAI,CAASf,OAAO,0KAA3Ca,GAAG,GAAHA,GAAG,CAAG,EAAE,WAAEC,MAAM,GAANA,MAAM,CAAG,EAAE,WAAEC,IAAI,GAAJA,IAAI,CAAG,IAAI,WAAEf,OAAO,GAAPA,OAAO,CAAG,CAAC,CAAC,EACnDgB,aAAa,CAAG,GAAAC,uCAAwB,EAACH,MAAM,CAAC,CAElDI,MAAM,CAAG,CACZlB,OAAO,0BACH,IAAI,CAACA,OAAO,CACZA,OAAO,CACV,CACDmB,YAAY,CAAE,IAAI,CAAClB,aAAa,CAChCmB,eAAe,GAAM,CACrBC,OAAO,CAAE,IAAI,CAACnB,eACf,CAAC,CAGDoB,cAAK,CAACC,QAAQ,CAACvB,OAAO,CAACwB,MAAM,OAAU,CAAGC,gCAAqB,CAC/DH,cAAK,CAACC,QAAQ,CAACvB,OAAO,CAACwB,MAAM,CAAC,cAAc,CAAC,CAAGC,gCAAqB,CAErEC,OAAO,CAACC,GAAG,CAACT,MAAM,CAAC,CAGbU,oBAAoB,CAAGN,cAAK,CAACO,MAAM,CAACX,MAAM,CAAC,CAGjDU,oBAAoB,CAACE,YAAY,CAACC,OAAO,CAACC,GAAG,CAC5C,SAACd,MAAM,QACN,IAAIe,QAAO,CAAC,SAACC,OAAO,CAAK,IAEpBC,iBAAgB,CAAG,GAAAC,kBAAQ,EAAC,iBAAM,MAAI,CAAC1B,gBAAgB,EAAE,EAAE,KAAI,CAACJ,yBAAyB,CAAC,CAG1F+B,gBAAgB,CAAG,GAAAC,kBAAQ,EAAC,UAAM,CACrCC,aAAa,CAACF,gBAAgB,CAAC,CAC/BF,gBAAgB,EAAE,CAClBD,OAAO,CAAChB,MAAM,CACf,CAAC,CAAE,KAAI,CAACd,yBAAyB,CAAC,CAiBlC,MAfI,MAAI,CAACM,gBAAgB,EAAI,KAAI,CAACF,mBAAmB,GACpDkB,OAAO,CAACc,IAAI,KAAK,GAAAC,uCAAwB,EAAC3B,MAAM,CAAC,MAAKD,GAAG,aAAY,CAGrEwB,gBAAgB,EAAE,EAGf,KAAI,CAAC3B,gBAAgB,CAAG,KAAI,CAACF,mBAAmB,EAEnDkB,OAAO,CAACc,IAAI,KAAK,GAAAC,uCAAwB,EAAC3B,MAAM,CAAC,MAAKD,GAAG,oBAAmB,KAAI,CAACH,gBAAgB,cAAoC,CAAC,CAAzB,KAAI,CAACA,gBAAoB,CAAG,UAAU,CAAG,SAAS,MAAI,CAIpK,KAAI,CAACA,gBAAgB,EAAE,CAEhBQ,MACR,CAAC,CAAC,EACH,CACA,SAACwB,GAAG,QACH,IAAIT,QAAO,CAAC,SAACC,OAAO,CAAK,CAMxB,MAJAR,QAAO,CAACiB,IAAI,KAAK,GAAAF,uCAAwB,EAAC3B,MAAM,CAAC,MAAKD,GAAG,QAAO6B,GAAG,CAACE,MAAM,KAAIF,GAAG,CAACG,UAAU,KAAI,CAChGX,OAAO,CAACQ,GAAG,CAAC,CAGLA,GACR,CAAC,CAAC,EACH,SAACI,GAAG,QACH,IAAIb,QAAO,CAAC,SAACc,MAAM,CAAK,CAOvB,MALArB,QAAO,CAACsB,KAAK,KAAK,GAAAP,uCAAwB,EAAC3B,MAAM,CAAC,MAAKD,GAAG,cAAa,CACvEa,OAAO,CAACsB,KAAK,CAAC,IAAI,CAAEF,GAAG,CAACG,OAAO,CAAE,IAAI,CAAC,CACtCF,MAAM,CAACD,GAAG,CAAC,CAGJA,GACR,CAAC,CAAC,EAGJlB,oBAAoB,CAACE,YAAY,CAACoB,QAAQ,CAAClB,GAAG,CAC7C,SAACU,GAAG,QACH,IAAIT,QAAO,CAAC,SAACC,OAAO,CAAK,CAQxB,MANA,MAAI,CAACxB,gBAAgB,CAAGyC,IAAI,CAACC,GAAG,CAAC,CAAC,CAA0B,CAAC,CAAzB,KAAI,CAAC1C,gBAAoB,CAAG,KAAI,CAACA,gBAAgB,CAAG,CAAC,CAAG,CAAC,CAAC,CAG9FgB,OAAO,CAACiB,IAAI,KAAK,GAAAF,uCAAwB,EAAC3B,MAAM,CAAC,MAAKD,GAAG,QAAO6B,GAAG,CAACE,MAAM,KAAIF,GAAG,CAACG,UAAU,OAAM,KAAI,CAACnC,gBAAgB,cAAoC,CAAC,CAAzB,KAAI,CAACA,gBAAoB,CAAG,UAAU,CAAG,SAAS,MAAI,CAGlLwB,OAAO,CAACQ,GAAG,CACnB,CAAC,CAAC,EACH,CACA,SAACI,GAAG,QACH,IAAIb,QAAO,CAAC,SAACc,MAAM,CAAK,CAoBvB,MAnBID,IAAG,CAACI,QAAQ,EAEf,KAAI,CAACxC,gBAAgB,CAAGyC,IAAI,CAACC,GAAG,CAAC,CAAC,CAA0B,CAAC,CAAzB,KAAI,CAAC1C,gBAAoB,CAAG,KAAI,CAACA,gBAAgB,CAAG,CAAC,CAAG,CAAC,CAAC,CAG9FgB,OAAO,CAACsB,KAAK,KAAK,GAAAP,uCAAwB,EAAC3B,MAAM,CAAC,MAAKD,GAAG,QAAOiC,GAAG,CAACI,QAAQ,CAACN,MAAM,KAAIE,GAAG,CAACI,QAAQ,CAACL,UAAU,KAAI,EACzGC,GAAG,CAACf,OAAO,EAErB,KAAI,CAACrB,gBAAgB,CAAGyC,IAAI,CAACC,GAAG,CAAC,CAAC,CAA0B,CAAC,CAAzB,KAAI,CAAC1C,gBAAoB,CAAG,KAAI,CAACA,gBAAgB,CAAG,CAAC,CAAG,CAAC,CAAC,CAG9FgB,OAAO,CAACsB,KAAK,KAAK,GAAAP,uCAAwB,EAAC3B,MAAM,CAAC,MAAKD,GAAG,QAAOiC,GAAG,CAACf,OAAO,CAACa,MAAM,KAAIE,GAAG,CAACf,OAAO,CAACc,UAAU,KAAI,GAGjHnB,OAAO,CAACsB,KAAK,KAAK,GAAAP,uCAAwB,EAAC3B,MAAM,CAAC,MAAKD,GAAG,cAAa,CACvEa,OAAO,CAACsB,KAAK,CAAC,IAAI,CAAEF,GAAG,CAACG,OAAO,CAAE,IAAI,CAAC,EAIhCF,MAAM,CAACD,GAAG,CAClB,CAAC,CAAC,cAEI9B,aAAa,eACf,KAAK,kBAGL,MAAM,2DAFJY,oBAAoB,CAACyB,GAAG,CAACxC,GAAG,CAAEE,IAAI,CAAC,4EAGnCa,oBAAoB,CAAC0B,IAAI,CAACzC,GAAG,CAAEE,IAAI,CAAC,yDAGpC,IAAIwC,MAAK,QAAQvC,aAAa,uCAAsC,2DAE5E"}