{"version":3,"file":"request.js","names":["Request","hostname","headers","response_type","request_timeout","REQUEST_TIMEOUT","request_throttle_interval","REQUEST_THROTTLE_INTERVAL","request_debounce_interval","REQUEST_DEBOUNCE_INTERVAL","request_concurrency","REQUEST_CONCURRENCY","pending_requests","REQUEST_PENDING_COUNT","run","url","method","body","updatedMethod","convertStringToLowercase","config","responseType","withCredentials","timeout","axios","defaults","common","REQUEST_ACCEPT_HEADER","RequestAxiosInstance","create","interceptors","request","use","debounceInterval","debounce","throttleInterval","throttle","clearInterval","console","warn","convertStringToUppercase","res","info","status","statusText","err","error","message","response","Math","max","data","length","Object","keys","convertObjectToString","get","then","catch","results","post","Error"],"sources":["../src/libs/request.js"],"sourcesContent":["\"use strict\";\n\nimport axios from \"axios\";\nimport { REQUEST_ACCEPT_HEADER, REQUEST_CONCURRENCY, REQUEST_DEBOUNCE_INTERVAL, REQUEST_PENDING_COUNT, REQUEST_THROTTLE_INTERVAL, REQUEST_TIMEOUT } from \"../constants\";\nimport { convertObjectToString, convertStringToLowercase, convertStringToUppercase } from \"../utils/convertValues\";\nimport { debounce } from \"../utils/debounce\";\nimport { throttle } from \"../utils/throttle\";\n\nexport class Request {\n\tconstructor(\n\t\thostname,\n\t\t{ headers = null, response_type = null, request_timeout = REQUEST_TIMEOUT, request_throttle_interval = REQUEST_THROTTLE_INTERVAL, request_debounce_interval = REQUEST_DEBOUNCE_INTERVAL, request_concurrency = REQUEST_CONCURRENCY } = {}\n\t) {\n\t\tthis.hostname = hostname;\n\t\tthis.response_type = response_type;\n\t\tthis.headers = headers;\n\t\tthis.pending_requests = REQUEST_PENDING_COUNT;\n\t\tthis.request_timeout = request_timeout;\n\t\tthis.request_throttle_interval = request_throttle_interval;\n\t\tthis.request_debounce_interval = request_debounce_interval;\n\t\tthis.request_concurrency = request_concurrency;\n\t}\n\n\t/**\n\t * @description Handle running API requests\n\t * @param {String} url\n\t * @param {String} method\n\t * @param {Object} body\n\t * @param {Object} headers\n\t */\n\tasync run({ url = null, method = null, body = null, headers = null }) {\n\t\tconst updatedMethod = convertStringToLowercase(method);\n\n\t\tlet config = {\n\t\t\theaders: {\n\t\t\t\t...this.headers,\n\t\t\t\t...headers\n\t\t\t},\n\t\t\tresponseType: this.response_type,\n\t\t\twithCredentials: true,\n\t\t\ttimeout: this.request_timeout\n\t\t};\n\n\t\t// Override default `axios` instance\n\t\taxios.defaults.headers.common[\"Accept\"] = REQUEST_ACCEPT_HEADER;\n\t\taxios.defaults.headers.common[\"Content-Type\"] = REQUEST_ACCEPT_HEADER;\n\n\t\t// Custom `request` instance\n\t\tconst RequestAxiosInstance = axios.create(config);\n\n\t\t// Use `axios` interceptors for all HTTP methods (GET, POST, PUT, DELETE, etc.)\n\t\tRequestAxiosInstance.interceptors.request.use((config) => {\n\t\t\t// Debounce requests to avoid rate limiting\n\t\t\tlet debounceInterval = debounce(() => this.pending_requests--, this.request_debounce_interval);\n\n\t\t\t// Throttle requests to avoid rate limiting\n\t\t\tlet throttleInterval = throttle(() => {\n\t\t\t\tclearInterval(throttleInterval);\n\t\t\t\tdebounceInterval();\n\n\t\t\t\treturn config;\n\t\t\t}, this.request_throttle_interval);\n\n\t\t\tif (this.pending_requests <= this.request_concurrency) {\n\t\t\t\tconsole.warn(`[${convertStringToUppercase(method)}] ${url} - (SENT)`);\n\n\t\t\t\t// Wait for all throttle to clear\n\t\t\t\tthrottleInterval();\n\t\t\t}\n\n\t\t\tif (this.pending_requests > this.request_concurrency) {\n\t\t\t\t// Return null if there are too many pending requests\n\t\t\t\tconsole.warn(`[${convertStringToUppercase(method)}] ${url} - (THROTTLED) (${this.pending_requests} pending ${this.pending_requests > 1 ? \"requests\" : \"request\"})`);\n\t\t\t}\n\n\t\t\t// Increment pending requests\n\t\t\tthis.pending_requests++;\n\n\t\t\treturn config;\n\t\t}),\n\t\t\t(res) => {\n\t\t\t\t// Send info message to console if request is successful\n\t\t\t\tconsole.info(`[${convertStringToUppercase(method)}] ${url} - (${res?.status} ${res?.statusText})`);\n\n\t\t\t\t// Return response\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\t(err) => {\n\t\t\t\t// Send error message to console if request fails\n\t\t\t\tconsole.error(`[${convertStringToUppercase(method)}] ${url} - (ERROR)`);\n\t\t\t\tconsole.error(\"\\n\", err.message, \"\\n\");\n\n\t\t\t\t// Return error message\n\t\t\t\treturn err;\n\t\t\t};\n\n\t\t// Use `axios` interceptors for all HTTP methods (GET, POST, PUT, DELETE, etc.)\n\t\tRequestAxiosInstance.interceptors.response.use((res) => {\n\t\t\t// Decrement pending requests\n\t\t\tthis.pending_requests = Math.max(0, this.pending_requests > 0 ? this.pending_requests - 1 : 0);\n\n\t\t\t// Send info message to console if request is successful\n\t\t\tconsole.info(\n\t\t\t\t`[${convertStringToUppercase(method)}] ${url} - (${res?.status} ${res?.statusText}) - (${res?.data?.length || Object.keys(res?.data)?.length || 0} ${\n\t\t\t\t\tres?.data?.length === 1 || Object.keys(res?.data)?.length === 1 ? \"item\" : \"items\"\n\t\t\t\t}) - (${this.pending_requests} pending ${this.pending_requests > 1 ? \"requests\" : \"request\"})`\n\t\t\t);\n\n\t\t\t// Return response\n\t\t\treturn res;\n\t\t}),\n\t\t\t(err) => {\n\t\t\t\tif (err.response) {\n\t\t\t\t\t// Decrement pending requests\n\t\t\t\t\tthis.pending_requests = Math.max(0, this.pending_requests > 0 ? this.pending_requests - 1 : 0);\n\n\t\t\t\t\t// Send log message when error response is received\n\t\t\t\t\tconsole.error(`[${convertStringToUppercase(method)}] ${url} - (${err.response.status} ${err.response.statusText})`);\n\t\t\t\t} else if (err.request) {\n\t\t\t\t\t// Decrement pending requests\n\t\t\t\t\tthis.pending_requests = Math.max(0, this.pending_requests > 0 ? this.pending_requests - 1 : 0);\n\n\t\t\t\t\t// Send log message when error request is received\n\t\t\t\t\tconsole.error(`[${convertStringToUppercase(method)}] ${url} - (${err.request.status} ${err.request.statusText})`);\n\t\t\t\t} else {\n\t\t\t\t\t// Send log message when error is thrown\n\t\t\t\t\tconsole.error(`[${convertStringToUppercase(method)}] ${url} - (ERROR)`);\n\t\t\t\t\tconsole.error(\"\\n\", `${err?.message || convertObjectToString(err) || \"An error occurred. Please try again later.\"}`, \"\\n\");\n\t\t\t\t}\n\n\t\t\t\t// Return error message\n\t\t\t\treturn err;\n\t\t\t};\n\n\t\tswitch (updatedMethod) {\n\t\t\tcase \"get\": {\n\t\t\t\tconst results = await RequestAxiosInstance.get(url, body)\n\t\t\t\t\t.then((res) => res)\n\t\t\t\t\t.catch((err) => err);\n\n\t\t\t\treturn results;\n\t\t\t}\n\t\t\tcase \"post\": {\n\t\t\t\tconst results = await RequestAxiosInstance.post(url, body)\n\t\t\t\t\t.then((res) => res)\n\t\t\t\t\t.catch((err) => err);\n\n\t\t\t\treturn results;\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`The ${updatedMethod} method is currently not supported.`);\n\t\t}\n\t}\n}\n"],"mappings":"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"}