"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=!0,exports.default=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_axios=_interopRequireDefault(require("axios")),_qs=_interopRequireDefault(require("qs")),_constants=require("../constants"),Auth=function(){function Auth(config){if(!config)throw new Error("Optimizely/Episerver API auth config required. It is required to make any call to the API");this.site_url=config.site_url,this.username=config.username,this.password=config.password,this.grant_type=config.grant_type,this.client_id=config.client_id,this.response_type=config.response_type,this.request_timeout=config.request_timeout}var _proto=Auth.prototype;return _proto.post=function(){function post(){return _post.apply(this,arguments)}var _post=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee(){var config,_yield$axios$then$cat,data;return _regenerator.default.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return config={method:"post",url:this.site_url+_constants.AUTH_ENDPOINT,headers:{Accept:_constants.REQUEST_ACCEPT_HEADER,"Content-Type":_constants.AUTH_REQUEST_CONTENT_TYPE_HEADER},responseType:this.response_type,timeout:this.request_timeout,data:_qs.default.stringify({password:this.password,username:this.username,grant_type:this.grant_type,client_id:this.client_id},{encode:!1})},_axios.default.defaults.headers.common.Accept=_constants.REQUEST_ACCEPT_HEADER,_axios.default.defaults.headers.common["Content-Type"]=_constants.REQUEST_ACCEPT_HEADER,_context.next=5,(0,_axios.default)(config).then(function(res){return console.info("["+config.method.toUpperCase()+"] "+config.url+" ("+res.statusText+")"),res}).catch(function(err){throw console.error("["+config.method.toUpperCase()+"] "+config.url+" - "+err.message),err});case 5:return _yield$axios$then$cat=_context.sent,data=_yield$axios$then$cat.data,_context.abrupt("return",data);case 8:case"end":return _context.stop();}},_callee,this)}));return post}(),Auth}(),_default=Auth;exports.default=_default;
//# sourceMappingURL=auth.js.map